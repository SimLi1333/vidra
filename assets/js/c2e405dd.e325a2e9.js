"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5190],{2866:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/C2.drawio-df5b7198a068905d029d51af9378ace5.png"},4469:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/C3.drawio-a48c026f8d76be55382452db195bcef6.png"},7293:(e,n,i)=>{i.d(n,{A:()=>z});var r=i(6540),t=i(4848);function s(e){const{mdxAdmonitionTitle:n,rest:i}=function(e){const n=r.Children.toArray(e),i=n.find((e=>r.isValidElement(e)&&"mdxAdmonitionTitle"===e.type)),s=n.filter((e=>e!==i)),a=i?.props.children;return{mdxAdmonitionTitle:a,rest:s.length>0?(0,t.jsx)(t.Fragment,{children:s}):null}}(e.children),s=e.title??n;return{...e,...s&&{title:s},children:i}}var a=i(4164),o=i(1312),c=i(7559);const l="admonition_xJq3",d="admonitionHeading_Gvgb",h="admonitionIcon_Rf37",u="admonitionContent_BuS1";function g({type:e,className:n,children:i}){return(0,t.jsx)("div",{className:(0,a.A)(c.G.common.admonition,c.G.common.admonitionType(e),l,n),children:i})}function f({icon:e,title:n}){return(0,t.jsxs)("div",{className:d,children:[(0,t.jsx)("span",{className:h,children:e}),n]})}function m({children:e}){return e?(0,t.jsx)("div",{className:u,children:e}):null}function p(e){const{type:n,icon:i,title:r,children:s,className:a}=e;return(0,t.jsxs)(g,{type:n,className:a,children:[r||i?(0,t.jsx)(f,{title:r,icon:i}):null,(0,t.jsx)(m,{children:s})]})}function x(e){return(0,t.jsx)("svg",{viewBox:"0 0 14 16",...e,children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})})}const j={icon:(0,t.jsx)(x,{}),title:(0,t.jsx)(o.A,{id:"theme.admonition.note",description:"The default label used for the Note admonition (:::note)",children:"note"})};function v(e){return(0,t.jsx)(p,{...j,...e,className:(0,a.A)("alert alert--secondary",e.className),children:e.children})}function b(e){return(0,t.jsx)("svg",{viewBox:"0 0 12 16",...e,children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})})}const y={icon:(0,t.jsx)(b,{}),title:(0,t.jsx)(o.A,{id:"theme.admonition.tip",description:"The default label used for the Tip admonition (:::tip)",children:"tip"})};function w(e){return(0,t.jsx)(p,{...y,...e,className:(0,a.A)("alert alert--success",e.className),children:e.children})}function A(e){return(0,t.jsx)("svg",{viewBox:"0 0 14 16",...e,children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})})}const C={icon:(0,t.jsx)(A,{}),title:(0,t.jsx)(o.A,{id:"theme.admonition.info",description:"The default label used for the Info admonition (:::info)",children:"info"})};function I(e){return(0,t.jsx)(p,{...C,...e,className:(0,a.A)("alert alert--info",e.className),children:e.children})}function D(e){return(0,t.jsx)("svg",{viewBox:"0 0 16 16",...e,children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})})}const R={icon:(0,t.jsx)(D,{}),title:(0,t.jsx)(o.A,{id:"theme.admonition.warning",description:"The default label used for the Warning admonition (:::warning)",children:"warning"})};function T(e){return(0,t.jsx)("svg",{viewBox:"0 0 12 16",...e,children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"})})}const V={icon:(0,t.jsx)(T,{}),title:(0,t.jsx)(o.A,{id:"theme.admonition.danger",description:"The default label used for the Danger admonition (:::danger)",children:"danger"})};const k={icon:(0,t.jsx)(D,{}),title:(0,t.jsx)(o.A,{id:"theme.admonition.caution",description:"The default label used for the Caution admonition (:::caution)",children:"caution"})};const K={...{note:v,tip:w,info:I,warning:function(e){return(0,t.jsx)(p,{...R,...e,className:(0,a.A)("alert alert--warning",e.className),children:e.children})},danger:function(e){return(0,t.jsx)(p,{...V,...e,className:(0,a.A)("alert alert--danger",e.className),children:e.children})}},...{secondary:e=>(0,t.jsx)(v,{title:"secondary",...e}),important:e=>(0,t.jsx)(I,{title:"important",...e}),success:e=>(0,t.jsx)(w,{title:"success",...e}),caution:function(e){return(0,t.jsx)(p,{...k,...e,className:(0,a.A)("alert alert--warning",e.className),children:e.children})}}};function z(e){const n=s(e),i=(r=n.type,K[r]||(console.warn(`No admonition component found for admonition type "${r}". Using Info as fallback.`),K.info));var r;return(0,t.jsx)(i,{...n})}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>o});var r=i(6540);const t={},s=r.createContext(t);function a(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(s.Provider,{value:n},e.children)}},8531:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/C1.drawio-78024259a8683ffd0f1dc5ab3866d8e5.png"},9064:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/data-flow.drawio-c24e9ae03fe0c681cb466d05a11eb166.png"},9778:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"topics/architecture","title":"Architecture","description":"Introduction","source":"@site/docs/topics/architecture.md","sourceDirName":"topics","slug":"/topics/architecture","permalink":"/vidra/topics/architecture","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Architecture","sidebar_position":1},"sidebar":"cliSidebar","previous":{"title":"API References","permalink":"/vidra/api-references/"},"next":{"title":"Use Markdown Architectural Decision Records","permalink":"/vidra/topics/desicions/use-markdown-architectural-decision-records"}}');var t=i(4848),s=i(8453),a=i(7293);const o={title:"Architecture",sidebar_position:1},c=void 0,l={},d=[{value:"Introduction",id:"introduction",level:2},{value:"1. Overview of Vidra Architecture",id:"1-overview-of-vidra-architecture",level:2},{value:"Key Architectural Goals:",id:"key-architectural-goals",level:3},{value:"2. C4 Model",id:"2-c4-model",level:2},{value:"System Context Diagram (C1)",id:"system-context-diagram-c1",level:3},{value:"Container Diagram (C2)",id:"container-diagram-c2",level:3},{value:"Component Diagram (C3)",id:"component-diagram-c3",level:3},{value:"High-Level Code Structure (C4)",id:"high-level-code-structure-c4",level:2},{value:"2.1 API Layer",id:"21-api-layer",level:3},{value:"2.2 Domain Layer",id:"22-domain-layer",level:3},{value:"2.3 Controller Layer",id:"23-controller-layer",level:3},{value:"2.4 Adapter Layer",id:"24-adapter-layer",level:3},{value:"3. Data Flow and Interaction",id:"3-data-flow-and-interaction",level:2},{value:"4. Design Patterns and Technologies",id:"4-design-patterns-and-technologies",level:2},{value:"5. Error Handling and Resilience",id:"5-error-handling-and-resilience",level:2},{value:"6. Extensibility and Future Directions",id:"6-extensibility-and-future-directions",level:2}];function h(e){const n={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsxs)(n.p,{children:["Vidra is a ",(0,t.jsx)(n.strong,{children:"Kubernetes operator"})," that automates the synchronization and management of infrastructure resources via the Infrahub platform. It streamlines the process of querying, retrieving, and applying configuration artifacts to Kubernetes clusters, enabling efficient and automated infrastructure lifecycle management."]}),"\n",(0,t.jsx)(n.p,{children:"The architecture is modular, extensible, and resilient, following Kubernetes operator patterns and cloud-native best practices. This section describes Vidra\u2019s core components, data flow, interactions, and design rationale."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"1-overview-of-vidra-architecture",children:"1. Overview of Vidra Architecture"}),"\n",(0,t.jsxs)(n.p,{children:["Vidra is implemented as a ",(0,t.jsx)(n.strong,{children:"Kubernetes operator"}),", extending the Kubernetes control plane to manage custom resources representing Infrahub synchronization configurations. The operator continuously reconciles desired states defined in infrahub into custom resources which are used to reconcile with the actual cluster state, ensuring automated, declarative management of kubernetes resources."]}),"\n",(0,t.jsx)(n.h3,{id:"key-architectural-goals",children:"Key Architectural Goals:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Declarative Resource Management:"})," Users specify synchronization requirements via custom resources; Vidra automates downstream artifact application."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"GitOps Principles:"})," Supports GitOps-based workflows, allowing users to define infrastructure in Infrahub and manage it through version control."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Extensibility:"})," Modular architecture enables support for additional artifact types, expanded Infrahub query capabilities, and even integration with any other system that generate manifests."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Scalability and Robustness:"})," Efficient handling of concurrent sync operations with robust error handling."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Separation of Concerns:"})," Clear boundaries between domain logic, external system integration, and Kubernetes API interactions."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"2-c4-model",children:"2. C4 Model"}),"\n",(0,t.jsx)(n.p,{children:"The following diagrams illustrate the C4 model for Vidra, providing a high-level perspective on its architecture and interactions within the Kubernetes ecosystem."}),"\n",(0,t.jsx)(n.h3,{id:"system-context-diagram-c1",children:"System Context Diagram (C1)"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"System Context Diagram",src:i(8531).A+"",width:"927",height:"507"})}),"\n",(0,t.jsx)(n.h3,{id:"container-diagram-c2",children:"Container Diagram (C2)"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Container Diagram",src:i(2866).A+"",width:"1367",height:"940"})}),"\n",(0,t.jsx)(n.h3,{id:"component-diagram-c3",children:"Component Diagram (C3)"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Component Diagram",src:i(4469).A+"",width:"1433",height:"794"})}),"\n",(0,t.jsx)(n.h2,{id:"high-level-code-structure-c4",children:"High-Level Code Structure (C4)"}),"\n",(0,t.jsx)(n.p,{children:"Vidra is structured into four primary layers, each implemented as a distinct Go package to promote a clean, maintainable architecture:"}),"\n",(0,t.jsx)(n.h3,{id:"21-api-layer",children:"2.1 API Layer"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/vidra/api-references/",children:"API Layer"})})," exposes Vidra\u2019s functionality to users through well-defined custom resource definitions (CRDs) and their schemas."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"InfrahubSync CRD:"})," The primary entry point for configuring Vidra, allowing users to specify synchronization parameters."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"VidraResource CRD:"})," Defines the structure for Kubernetes resources managed by Vidra, enabling declarative management of cluster artifacts."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["The API Layer can be found ",(0,t.jsx)(n.a,{href:"https://github.com/infrahub-operator/vidra/tree/main/api/v1alpha1",children:"here"})]}),"\n",(0,t.jsx)(n.h3,{id:"22-domain-layer",children:"2.2 Domain Layer"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:"Domain Layer"})," defines Vidra\u2019s core business entities and domain interfaces. This layer is intentionally minimal, focusing all important entities primarily in the ",(0,t.jsx)(n.code,{children:"InfrahubSync"})," and ",(0,t.jsx)(n.code,{children:"VidraResource"})," custom resources, which represent the essential concepts and behaviors within Vidra."]}),"\n",(0,t.jsxs)(n.p,{children:["The only entitie in domain layer so far is ",(0,t.jsx)(n.code,{children:"Artifact"}),", which represents the Infrahub artifact that is downloaded and applied to the cluster. It contains metadata about the artifact, such as its ID, name, and checksum."]}),"\n",(0,t.jsx)(n.h3,{id:"23-controller-layer",children:"2.3 Controller Layer"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:"Controller Layer"})," implements the reconciliation logic that drives Vidra\u2019s continuous delivery workflows. Controllers monitor changes to custom resources and orchestrate the necessary actions to align cluster state with the desired state. Controller implements the use-cases of the custom resources and orchestrates the necessary actions to align cluster state with the desired configuration."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"InfrahubSyncReconciler:"})," Handles all tasks related to Infrahub, including authentication, querying, artifact retrieval, and triggering downstream synchronization."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"VidraResourceReconciler:"})," Manages the lifecycle of Kubernetes resources, applying, updating, or deleting manifests as needed."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Each controller is dedicated to a specific CRD, ensuring clear separation of concerns and enabling future extensibility."}),"\n",(0,t.jsx)(n.h3,{id:"24-adapter-layer",children:"2.4 Adapter Layer"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:"Adapter Layer"})," manages integrations with external systems, such as Infrahub and Kubernetes clusters. It handles API communication, artifact processing, and abstracts external dependencies behind interfaces, facilitating testing and future expansion."]}),"\n",(0,t.jsx)(n.p,{children:"While Kubernetes is not a direct external system, we put the actions done by additional go clients (like talking to other clusters or handling eventbased reconciliation) into the adapter layer, as they are not part of the core controller logic."}),"\n",(0,t.jsx)(n.p,{children:"This layered approach enforces separation of concerns, simplifies testing, and enables future extensibility. Dependencies between layers are managed through interfaces, allowing for easy mocking and unit testing. Importantly, dependencies only go inward\u2014outer layers depend on inner layers, but not vice versa\u2014ensuring a clean, maintainable architecture."}),"\n",(0,t.jsx)(a.A,{type:"note",title:"Note",children:(0,t.jsxs)(n.p,{children:["You can explore the implementation of these three layers (Domain, Controller, Adapter) in the ",(0,t.jsx)(n.a,{href:"https://github.com/infrahub-operator/vidra/tree/main/internal",children:"internal directory"})," of the Vidra repository."]})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"3-data-flow-and-interaction",children:"3. Data Flow and Interaction"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Custom Resource Creation (CR):"}),(0,t.jsx)(n.br,{}),"\n","Users create an ",(0,t.jsx)(n.code,{children:"InfrahubSync"})," resource, specifying parameters such as the Infrahub query, target artifact, target branch, and (optionally) a target date. This resource acts as the declarative specification for what should be synchronized from Infrahub into the Kubernetes cluster."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Event Trigger:"})," The Kubernetes API server notifies the infrahubSync controller of the resource creation or update."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"InfrahubSync Reconciliation Loop:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Retrieves User and Password from the Secret with annotation ",(0,t.jsx)(n.code,{children:"infrahub-api-url: <infrahub-api-url>"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"Authenticates to Infrahub using configured credentials."}),"\n",(0,t.jsxs)(n.li,{children:["Executes the specified query (in ConfigMap ",(0,t.jsx)(n.code,{children:"vidra-config"}),") on Infrahub and retrieves metadata about the resulting artifact."]}),"\n",(0,t.jsx)(n.li,{children:"Downloads the artifacts (e.g., a Kubernetes manifest bundle) if the checksum of the Artifact did change."}),"\n",(0,t.jsxs)(n.li,{children:["Applies the artifacts and its manifests each to a ",(0,t.jsx)(n.code,{children:"VidraResource"})," with the artifact ID as name."]}),"\n",(0,t.jsx)(n.li,{children:"Updates resource status to reflect success or failure of the sync process."}),"\n",(0,t.jsx)(n.li,{children:"Adds itself to a time-based reconcile queue, ensuring periodic checks for updates or changes to the InfrahubSync resource."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Event Trigger:"})," The Kubernetes API server notifies the vidraResource controller of the resource creation or update."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"VidraResource Reconciliation Loop:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Monitors ",(0,t.jsx)(n.code,{children:"VidraResource"})," CR's created by the InfrahubSync controller."]}),"\n",(0,t.jsx)(n.li,{children:"Applies the manifests to the destination Kubernetes cluster (can be a different cluster), ensuring the desired state matches the actual state."}),"\n",(0,t.jsx)(n.li,{children:"Creates lists and finalizers of the managed resources, allowing for easy tracking, management and deletion of resources or VidraResources."}),"\n",(0,t.jsx)(n.li,{children:"Applies event based reconciliation if configured to do so, where changes to the managed resources triggers reconciliation or adds a timebased reconcile interval."}),"\n",(0,t.jsx)(n.li,{children:"Updates resource status to reflect success or failure of the application process."}),"\n",(0,t.jsx)(n.li,{children:"Adds itself to a time-based reconcile queue, ensuring periodic checks for updates or changes to the VidraResource resource."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Vidra Data Flow",src:i(9064).A+"",width:"1433",height:"727"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"4-design-patterns-and-technologies",children:"4. Design Patterns and Technologies"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Operator SDK & Controller Runtime:"})," Vidra leverages the Operator SDK framework, providing scaffolding for controller creation, client interactions, and CR management."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Domain-Driven Design (DDD) / Clean Architecture:"})," Clear separation between domain entities, business logic, and infrastructure concerns to improve maintainability."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Interface Abstraction:"})," External system clients (Infrahub API, Kubernetes client) are abstracted by interfaces, facilitating unit testing and mocking."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Reconciliation Model:"})," Follows Kubernetes\u2019 declarative reconciliation paradigm, ensuring eventual consistency between desired and actual state."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Factory Pattern:"})," Used to create go-client used to connect to other Kubernetes clusters or managing EventBased scheduling, allowing for flexible configuration and easy testing."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Exponential Backoff:"})," Implements retry logic for transient errors during API calls (Infrahub and K8s), enhancing resilience against temporary failures."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Finalizers:"})," Utilized to manage resource cleanup and prevent premature deletion of resources while they are still being processed."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Event-Driven Architecture:"})," Controllers respond to Kubernetes events, lavraging a Kubernetes Concept called ",(0,t.jsx)(n.code,{children:"Informers"})," triggering reconciliation based on resource changes, ensuring timely updates and synchronization."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"5-error-handling-and-resilience",children:"5. Error Handling and Resilience"}),"\n",(0,t.jsx)(n.p,{children:"Vidra implements comprehensive error handling strategies:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Transient failures during API calls trigger retries with exponential backoff."}),"\n",(0,t.jsx)(n.li,{children:"Validation errors halt reconciliation with clear status messages which are statet in the resource status."}),"\n",(0,t.jsx)(n.li,{children:"Unexpected errors are logged and surfaced in resource conditions, enabling operators to diagnose issues."}),"\n",(0,t.jsx)(n.li,{children:"Concurrency controls (mutex) prevent conflicting go-client creation."}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"6-extensibility-and-future-directions",children:"6. Extensibility and Future Directions"}),"\n",(0,t.jsx)(n.p,{children:"The modular architecture of Vidra allows:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Adoption of additional artifact types, enabling reconciliation of any Kubernetes resource\u2014including custom resources (CRs)"}),"\n",(0,t.jsx)(n.li,{children:"Addition of new Infrahub query capabilities."}),"\n",(0,t.jsx)(n.li,{children:"Integration with other systems (e.g., Helm, GitOps) through the Adapter Layer."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This design ensures Vidra can evolve to meet growing infrastructure automation demands and diverse deployment scenarios."})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);