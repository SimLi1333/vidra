"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[116],{740:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/files/docs-866662ba84430cc8a44477a87f6648e3.yaml"},1014:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/files/main-c6875ce3e800a07dcd21f3f13327a9c1.yaml"},1257:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/files/cli-4e2839e1deb0f5cb725bd7025ddfa054.yaml"},7293:(e,n,i)=>{i.d(n,{A:()=>R});var t=i(6540),s=i(4848);function r(e){const{mdxAdmonitionTitle:n,rest:i}=function(e){const n=t.Children.toArray(e),i=n.find((e=>t.isValidElement(e)&&"mdxAdmonitionTitle"===e.type)),r=n.filter((e=>e!==i)),l=i?.props.children;return{mdxAdmonitionTitle:l,rest:r.length>0?(0,s.jsx)(s.Fragment,{children:r}):null}}(e.children),r=e.title??n;return{...e,...r&&{title:r},children:i}}var l=i(4164),o=i(1312),a=i(7559);const d="admonition_xJq3",c="admonitionHeading_Gvgb",h="admonitionIcon_Rf37",u="admonitionContent_BuS1";function g({type:e,className:n,children:i}){return(0,s.jsx)("div",{className:(0,l.A)(a.G.common.admonition,a.G.common.admonitionType(e),d,n),children:i})}function x({icon:e,title:n}){return(0,s.jsxs)("div",{className:c,children:[(0,s.jsx)("span",{className:h,children:e}),n]})}function p({children:e}){return e?(0,s.jsx)("div",{className:u,children:e}):null}function j(e){const{type:n,icon:i,title:t,children:r,className:l}=e;return(0,s.jsxs)(g,{type:n,className:l,children:[t||i?(0,s.jsx)(x,{title:t,icon:i}):null,(0,s.jsx)(p,{children:r})]})}function m(e){return(0,s.jsx)("svg",{viewBox:"0 0 14 16",...e,children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})})}const f={icon:(0,s.jsx)(m,{}),title:(0,s.jsx)(o.A,{id:"theme.admonition.note",description:"The default label used for the Note admonition (:::note)",children:"note"})};function v(e){return(0,s.jsx)(j,{...f,...e,className:(0,l.A)("alert alert--secondary",e.className),children:e.children})}function b(e){return(0,s.jsx)("svg",{viewBox:"0 0 12 16",...e,children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})})}const y={icon:(0,s.jsx)(b,{}),title:(0,s.jsx)(o.A,{id:"theme.admonition.tip",description:"The default label used for the Tip admonition (:::tip)",children:"tip"})};function C(e){return(0,s.jsx)(j,{...y,...e,className:(0,l.A)("alert alert--success",e.className),children:e.children})}function w(e){return(0,s.jsx)("svg",{viewBox:"0 0 14 16",...e,children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})})}const k={icon:(0,s.jsx)(w,{}),title:(0,s.jsx)(o.A,{id:"theme.admonition.info",description:"The default label used for the Info admonition (:::info)",children:"info"})};function A(e){return(0,s.jsx)(j,{...k,...e,className:(0,l.A)("alert alert--info",e.className),children:e.children})}function T(e){return(0,s.jsx)("svg",{viewBox:"0 0 16 16",...e,children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})})}const I={icon:(0,s.jsx)(T,{}),title:(0,s.jsx)(o.A,{id:"theme.admonition.warning",description:"The default label used for the Warning admonition (:::warning)",children:"warning"})};function H(e){return(0,s.jsx)("svg",{viewBox:"0 0 12 16",...e,children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"})})}const L={icon:(0,s.jsx)(H,{}),title:(0,s.jsx)(o.A,{id:"theme.admonition.danger",description:"The default label used for the Danger admonition (:::danger)",children:"danger"})};const O={icon:(0,s.jsx)(T,{}),title:(0,s.jsx)(o.A,{id:"theme.admonition.caution",description:"The default label used for the Caution admonition (:::caution)",children:"caution"})};const N={...{note:v,tip:C,info:A,warning:function(e){return(0,s.jsx)(j,{...I,...e,className:(0,l.A)("alert alert--warning",e.className),children:e.children})},danger:function(e){return(0,s.jsx)(j,{...L,...e,className:(0,l.A)("alert alert--danger",e.className),children:e.children})}},...{secondary:e=>(0,s.jsx)(v,{title:"secondary",...e}),important:e=>(0,s.jsx)(A,{title:"important",...e}),success:e=>(0,s.jsx)(C,{title:"success",...e}),caution:function(e){return(0,s.jsx)(j,{...O,...e,className:(0,l.A)("alert alert--warning",e.className),children:e.children})}}};function R(e){const n=r(e),i=(t=n.type,N[t]||(console.warn(`No admonition component found for admonition type "${t}". Using Info as fallback.`),N.info));var t;return(0,s.jsx)(i,{...n})}},7499:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/workflow-4d56b09bc7d9f1cb79277149bd0996b2.png"},7759:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/ci-727cf9200c3e095298c15575de077dd7.png"},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>o});var t=i(6540);const s={},r=t.createContext(s);function l(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(r.Provider,{value:n},e.children)}},8854:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"topics/ci","title":"Continuos Integration","description":"We use GitHub Actions as our CI/CD tool to automate testing, building, and documentation deployment for the Vidra Operator. Currently, we maintain three workflows:","source":"@site/docs/topics/ci.md","sourceDirName":"topics","slug":"/topics/ci","permalink":"/vidra/topics/ci","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"title":"Continuos Integration","sidebar_position":7},"sidebar":"cliSidebar","previous":{"title":"Testing","permalink":"/vidra/topics/testing"},"next":{"title":"Preliminary Work","permalink":"/vidra/topics/preliminary-work"}}');var s=i(4848),r=i(8453),l=i(7293);const o={title:"Continuos Integration",sidebar_position:7},a="Continuous Integration",d={},c=[{value:"Deploy Docs",id:"deploy-docs",level:2},{value:"Trigger",id:"trigger",level:3},{value:"Operator CI",id:"operator-ci",level:2},{value:"Trigger",id:"trigger-1",level:3},{value:"Lint and Test",id:"lint-and-test",level:3},{value:"Build and Publish the Operator",id:"build-and-publish-the-operator",level:3},{value:"Helm Chart",id:"helm-chart",level:3},{value:"Add Yaml files to the release",id:"add-yaml-files-to-the-release",level:3},{value:"Operator CLI",id:"operator-cli",level:2},{value:"Trigger",id:"trigger-2",level:3},{value:"Lint and Test",id:"lint-and-test-1",level:3},{value:"Build and Publish the CLI",id:"build-and-publish-the-cli",level:3},{value:"Code Quality and security Checks",id:"code-quality-and-security-checks",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"continuous-integration",children:"Continuous Integration"})}),"\n",(0,s.jsxs)(n.p,{children:["We use ",(0,s.jsx)(n.strong,{children:"GitHub Actions"})," as our CI/CD tool to automate testing, building, and documentation deployment for the ",(0,s.jsx)(n.strong,{children:"Vidra Operator"}),". Currently, we maintain three workflows:"]}),"\n",(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,s.jsx)("div",{children:(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:(0,s.jsx)("strong",{children:"Deploy Docs"})}),(0,s.jsx)("li",{children:(0,s.jsx)("strong",{children:"Operator CI"})}),(0,s.jsx)("li",{children:(0,s.jsx)("strong",{children:"Operator CLI"})}),(0,s.jsx)("li",{children:(0,s.jsx)("strong",{children:"Code Quality and Security Checks"})})]})}),(0,s.jsx)("img",{src:i(7499).A,alt:"Workflows",style:{height:250,marginRight:150}})]}),"\n",(0,s.jsx)(n.h2,{id:"deploy-docs",children:"Deploy Docs"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.strong,{children:"Deploy Docs"})," workflow automates the deployment of our Docusaurus documentation site to GitHub Pages whenever documentation files are updated. In addition to publishing the static site, it generates up-to-date API documentation for our Custom Resource Definitions (CRDs) using ",(0,s.jsx)(n.code,{children:"crd-ref-docs"})," (invoked via a ",(0,s.jsx)(n.code,{children:"Make"})," target). The workflow builds the static site\u2014including the auto-generated docs and site\u2014and pushes the result to the ",(0,s.jsx)(n.code,{children:"gh-pages"})," branch, ensuring that users always have access to the latest documentation."]}),"\n",(0,s.jsx)(n.h3,{id:"trigger",children:"Trigger"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Any push to the ",(0,s.jsx)(n.code,{children:"main"})," branch that affects documentation files."]}),"\n",(0,s.jsxs)(n.li,{children:["Specifically triggered when:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["A file in the ",(0,s.jsx)(n.code,{children:"docs/"})," directory is changed."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Check the ",(0,s.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:i(740).A+"",children:(0,s.jsx)(n.code,{children:"docs.yaml"})})," workflow file for detailed configuration."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"operator-ci",children:"Operator CI"}),"\n",(0,s.jsx)(n.p,{children:"This workflow handles linting, testing, building, publishing and releasing the Vidra Operator to the GitHub Container Registry and Github itself."}),"\n",(0,s.jsx)(n.h3,{id:"trigger-1",children:"Trigger"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Every push to a pull request or push to the ",(0,s.jsx)(n.code,{children:"main"})," branch (protected)."]}),"\n",(0,s.jsx)(n.li,{children:"If any file coresponding to the operator is changed."}),"\n",(0,s.jsxs)(n.li,{children:["Pushing a version tag (e.g., ",(0,s.jsx)(n.code,{children:"v0.0.3"}),") will trigger the build and release process. Version is also tracked in the ",(0,s.jsx)(n.code,{children:"Makefile"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["You can find the workflow definition in ",(0,s.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:i(1014).A+"",children:(0,s.jsx)(n.code,{children:"main.yaml"})}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"CI Pipeline Overview",src:i(7759).A+"",width:"959",height:"281"})}),"\n",(0,s.jsx)(n.h3,{id:"lint-and-test",children:"Lint and Test"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Uses ",(0,s.jsx)(n.strong,{children:"golangci-lint"})," to perform static code analysis and linting on the Vidra Operator codebase."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Executes all tests for the Vidra Operator using ",(0,s.jsx)(n.code,{children:"go test"})," and Ginkgo-based test suites."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Tests are run using ",(0,s.jsx)(n.code,{children:"envtest"})," to provide a realistic Kubernetes API server."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["A test coverage report is generated and uploaded to ",(0,s.jsx)(n.strong,{children:"Codecov"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Pull requests where the code coverage drops below ",(0,s.jsx)(n.strong,{children:"80%"})," will or the new line of code are not covered by tests will have a warning comment added by the ",(0,s.jsx)(n.code,{children:"codecov"})," GitHub Action."]}),"\n",(0,s.jsx)(l.A,{type:"note",title:"Note",children:(0,s.jsx)(n.p,{children:"The Codecov badge in the README reflects the current coverage status."})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"build-and-publish-the-operator",children:"Build and Publish the Operator"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Uses the official ",(0,s.jsx)(n.strong,{children:"Docker GitHub Actions"})," to build the Vidra Operator image."]}),"\n",(0,s.jsxs)(n.li,{children:["Pushes the image to the ",(0,s.jsx)(n.strong,{children:"GitHub Container Registry (GHCR)"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["The image is tagged with the current version (e.g., ",(0,s.jsx)(n.code,{children:"v0.0.3"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:["The operator bundle is generated using ",(0,s.jsx)(n.code,{children:"Make bundle-build"})," and published to the GitHub Container Registry."]}),"\n",(0,s.jsxs)(n.li,{children:["The images are signed using ",(0,s.jsx)(n.strong,{children:"cosign"}),", allowing users to verify its authenticity and integrity."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"helm-chart",children:"Helm Chart"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Helmify is used to generate a Helm chart from the operator manifests, which is also published to the GitHub Container Registry."}),"\n",(0,s.jsx)(n.li,{children:"The Helm chart is versioned and tagged with the same version as the operator image."}),"\n",(0,s.jsx)(n.li,{children:"The Helm chart is automatically published to the GitHub Registry, making it easy for users to install the Vidra Operator using Helm. (OCI install)"}),"\n",(0,s.jsxs)(n.li,{children:["The packaged Helm Release and its index.yaml are also published to the ",(0,s.jsx)(n.code,{children:"gh-pages"})," branch of the repository and added to the release, allowing users to install the operator using the Helm repository."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"add-yaml-files-to-the-release",children:"Add Yaml files to the release"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The yaml files used for the install using OLM (Operator Lifecycle Manager) are added to the release with the correct version as well. This allows users to install the operator using OLM by applying the ",(0,s.jsx)(n.code,{children:"catalogsource.yaml"})," and ",(0,s.jsx)(n.code,{children:"subscription.yaml"})," files."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"operator-cli",children:"Operator CLI"}),"\n",(0,s.jsx)(n.p,{children:"This workflow is responsible for building and testing the Vidra Operator CLI tool, which provides a command-line interface for interacting with the Vidra Operator."}),"\n",(0,s.jsx)(n.h3,{id:"trigger-2",children:"Trigger"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Every push to a pull request or push to the ",(0,s.jsx)(n.code,{children:"main"})," branch (protected)."]}),"\n",(0,s.jsxs)(n.li,{children:["If any file corresponding to the operator CLI is changed.\nYou can find the workflow definition in ",(0,s.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:i(1257).A+"",children:(0,s.jsx)(n.code,{children:"cli.yaml"})}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"lint-and-test-1",children:"Lint and Test"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Uses ",(0,s.jsx)(n.strong,{children:"golangci-lint"})," to perform static code analysis and linting on the Vidra Operator CLI codebase."]}),"\n",(0,s.jsxs)(n.li,{children:["Executes all tests for the Vidra Operator CLI using ",(0,s.jsx)(n.code,{children:"go test"})," and Ginkgo-based test suites."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"build-and-publish-the-cli",children:"Build and Publish the CLI"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Uses the official ",(0,s.jsx)(n.strong,{children:"Docker GitHub Actions"})," to build the Vidra Operator CLI image."]}),"\n",(0,s.jsxs)(n.li,{children:["Pushes the image to the ",(0,s.jsx)(n.strong,{children:"GitHub Container Registry (GHCR)"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["The image is tagged with the current version (e.g., ",(0,s.jsx)(n.code,{children:"v0.0.3"}),")."]}),"\n",(0,s.jsx)(n.li,{children:"The CLI is built and packaged as a binary, which is also published to the GitHub Releases."}),"\n",(0,s.jsxs)(n.li,{children:["The CLI binary is signed using ",(0,s.jsx)(n.strong,{children:"cosign"}),", allowing users to verify its authenticity and integrity."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"code-quality-and-security-checks",children:"Code Quality and security Checks"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Dependabot"})," is configured to automatically create pull requests for dependency updates of packages used in the operator."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"CodeQL"})," is used to perform static code analysis and security checks on the codebase. It scans for vulnerabilities and potential issues in the code, helping maintain a high standard of code quality and security."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);