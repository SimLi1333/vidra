"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6760],{826:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"topics/desicions/finalizer","title":"Use of Finalizer for Resource Cleanup","description":"Context and Problem Statement","source":"@site/docs/topics/desicions/0010-finalizer.mdx","sourceDirName":"topics/desicions","slug":"/topics/desicions/finalizer","permalink":"/vidra/topics/desicions/finalizer","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":11,"frontMatter":{"title":"Use of Finalizer for Resource Cleanup","sidebar_position":11},"sidebar":"cliSidebar","previous":{"title":"Namespace Handling for Vidra-Managed Resources","permalink":"/vidra/topics/desicions/namespace"},"next":{"title":"Managed Resource Ownership and Cleanup Labels","permalink":"/vidra/topics/desicions/multi-ownment"}}');var r=s(4848),o=s(8453);const t={title:"Use of Finalizer for Resource Cleanup",sidebar_position:11},a="Use of Finalizer for Resource Cleanup",l={},c=[{value:"Context and Problem Statement",id:"context-and-problem-statement",level:2},{value:"Considered Options",id:"considered-options",level:2},{value:"Decision",id:"decision",level:2},{value:"Consequences",id:"consequences",level:2}];function d(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"use-of-finalizer-for-resource-cleanup",children:"Use of Finalizer for Resource Cleanup"})}),"\n",(0,r.jsx)(n.h2,{id:"context-and-problem-statement",children:"Context and Problem Statement"}),"\n",(0,r.jsxs)(n.p,{children:["Previously, we relied solely on Kubernetes ownership (",(0,r.jsx)(n.code,{children:"ownerReferences"}),") for managing the lifecycle of resources created by Vidra. This approach had limitations, especially in multi-cluster scenarios and when ensuring proper cleanup of all managed resources."]}),"\n",(0,r.jsx)(n.h2,{id:"considered-options",children:"Considered Options"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.strong,{children:["Rely solely on Kubernetes ",(0,r.jsx)(n.code,{children:"ownerReferences"})]}),(0,r.jsx)(n.br,{}),"\n","Use the built-in Kubernetes mechanism to automatically clean up dependent resources when the parent is deleted. This approach is simple but limited in multi-cluster scenarios and may not guarantee cleanup of all resources."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Implement a custom finalizer"}),(0,r.jsx)(n.br,{}),"\n","Attach a finalizer to Vidra resources, ensuring that all managed resources are explicitly deleted before the Vidra resource itself is removed. This provides more control and reliability, especially in complex or multi-cluster environments."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"decision",children:"Decision"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:'Chosen option: "Implement a custom finalizer"'}),", because it allows us to ensure that all resources created and managed by Vidra are properly cleaned up before the Vidra resource itself is deleted. This is particularly important in multi-cluster scenarios where Kubernetes ownership is not possble."]}),"\n",(0,r.jsx)(n.h2,{id:"consequences",children:"Consequences"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Good, because it provides a reliable mechanism for resource cleanup, ensuring that no resources are left orphaned after a Vidra resource is deleted."}),"\n",(0,r.jsx)(n.li,{children:"Good, because it allows using the same cleanup logic across different clusters, ensuring consistency in resource management."}),"\n",(0,r.jsx)(n.li,{children:"Bad, because it introduces additional complexity in managing finalizers and requires careful handling to avoid resource leaks if the finalizer logic fails."}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>a});var i=s(6540);const r={},o=i.createContext(r);function t(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);